<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tesla - Model S</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/@iterable/web-sdk/index.js"></script>
</head>

<body class="models">
    <div class="header" id="header">
        <nav>
            <img src="images/logo.png" class="logo">
            <ul>
                <li><a href="index.html">Model S</a></li>
                <li><a href="model3.html">Model 3</a></li>
                <li><a href="modelx.html">Model X</a></li>
                <li><a href="modely.html">Model Y</a></li>
            </ul>
            <a href="#" class="btn">Reserve Now</a>
        </nav>
        <div class="info">
            <div>
                <h2>1.9 s</h2>
                <p>0-60 mph</p>
            </div>
            <div>
                <h2>200 mph</h2>
                <p>Top Speed</p>
            </div>
            <div>
                <h2>390 mi</h2>
                <p>Max Range</p>
            </div>
            <div class="line"></div>
            <div>
                <h2 id="model">Model S</h2>
            </div>
        </div>
    </div>

    <script>
        window.addEventListener("load", function () {
            console.log('Checking Iterable SDK:', window['@iterable/web-sdk']);

            if (!window['@iterable/web-sdk']) {
                console.error('Iterable SDK is not available. Ensure the script loaded correctly.');
                return;
            }

            try {
                const { initialize, getInAppMessages } = window['@iterable/web-sdk'];

                if (!initialize) {
                    console.error('initialize function is missing in Iterable SDK.');
                    return;
                }

                const sdkInstance = initialize('c2d7324bd5a84684a7ebb14a985a4aa1');
                console.log('Iterable SDK initialized:', sdkInstance);

                if (!sdkInstance || typeof sdkInstance.setEmail !== 'function') {
                    console.error('Iterable SDK did not initialize correctly. Expected functions are missing.');
                    return;
                }

                const { setEmail, logout } = sdkInstance;

                setEmail('user@example.com') // Replace dynamically
                    .then(() => {
                        console.log('Email set successfully.');
                    })
                    .catch((error) => {
                        console.error('Error setting email:', error);
                    });

                if (getInAppMessages) {
                    const { request, pauseMessageStream, resumeMessageStream } = getInAppMessages(
                        {
                            count: 20,
                            packageName: 'tesla-website',
                            handleLinks: 'open-all-same-tab',
                        },
                        true
                    );
                    request();
                } else {
                    console.error('getInAppMessages is undefined.');
                }

            } catch (error) {
                console.error('Error initializing Iterable SDK:', error);
            }
        });
    </script>
</body>

</html>
